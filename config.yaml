# AI News Platform Configuration
# Add sources here without code changes - just edit this file!
# OpenAI and Hugging Face use rss_or_scrape (RSS with scrape fallback) per spec.

sources:
  - id: openai_news
    type: rss_or_scrape
    url: https://openai.com/news/rss.xml
    category: news
    authority: 1.0
    refresh_hours: 6
    lang: en
    user_agent: "Mozilla/5.0 (compatible; AINewsBot/1.0)"

  - id: deepmind_blog
    type: rss
    url: https://deepmind.google/blog/feed/basic/
    category: news
    authority: 0.95
    refresh_hours: 12
    lang: en
    user_agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"

  - id: hf_blog
    type: rss_or_scrape
    url: https://huggingface.co/blog/feed.xml
    category: news
    authority: 0.85
    refresh_hours: 12
    lang: en

  - id: hn_ai
    type: api
    url: https://hn.algolia.com/api/v1/search
    params:
      query: "(LLM OR agent OR RAG OR MCP)"
      tags: story
      hitsPerPage: 30
    category: news
    authority: 0.75
    refresh_hours: 6
    lang: en

  - id: github_ai_repos
    type: api
    url: https://api.github.com/search/repositories
    params:
      # Single topic (OR of multiple topic: qualifiers can trigger 422; use one broad topic)
      q: "llm in:topics"
      sort: stars
      order: desc
      per_page: 30
    category: news
    authority: 0.80
    refresh_hours: 24
    lang: en
    headers:
      Accept: "application/vnd.github+json"
      # Set GITHUB_TOKEN in .env to avoid 403 rate limit (unauthenticated is very limited)
      Authorization: "Bearer ${GITHUB_TOKEN}"

  - id: arxiv_api_llm
    type: api
    url: http://export.arxiv.org/api/query
    params:
      search_query: "(cat:cs.CL OR cat:cs.AI OR cat:cs.LG) AND (abs:LLM OR abs:agent OR abs:RAG)"
      start: 0
      max_results: 50
      sortBy: submittedDate
      sortOrder: descending
    category: paper
    authority: 0.90
    refresh_hours: 24
    lang: en

  - id: arxiv_rss_cscl
    type: rss
    url: https://rss.arxiv.org/rss/cs.CL
    category: paper
    authority: 0.85
    refresh_hours: 24
    lang: en
    user_agent: "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"

  # Zenn: use public JSON API (topic feed). RSS /topics/.../feed is often blocked for server requests.
  - id: zenn_llm
    type: api
    url: https://zenn.dev/api/articles
    params:
      topic: llm
      order: latest
      count: 30
    category: tips
    authority: 0.70
    refresh_hours: 12
    lang: ja

  - id: zenn_ai
    type: api
    url: https://zenn.dev/api/articles
    params:
      topic: ai
      order: latest
      count: 30
    category: tips
    authority: 0.70
    refresh_hours: 12
    lang: ja

  - id: qiita_llm
    type: api
    url: https://qiita.com/api/v2/items
    params:
      query: "tag:LLM OR tag:生成AI OR tag:ChatGPT"
      per_page: 30
      page: 1
    category: tips
    authority: 0.65
    refresh_hours: 12
    lang: ja
    headers:
      # Set QIITA_API_TOKEN in .env to get items (401 without it)
      Authorization: "Bearer ${QIITA_API_TOKEN}"

  - id: reddit_localllama
    type: rss
    url: https://www.reddit.com/r/LocalLLaMA/.rss
    category: tips
    authority: 0.70
    refresh_hours: 6
    lang: en
    # Reddit requires a descriptive User-Agent; default is browser-like
    user_agent: "python:ainews:1.0 (RSS reader; +https://github.com/ai-news-platform)"

  # --- Startup / VC / Industry additions ---
  - id: techcrunch_main
    type: rss
    url: https://techcrunch.com/feed/
    category: news
    authority: 0.78
    refresh_hours: 6
    lang: en
    notes: "Broad startup coverage; rely on keyword filter + quotas."

  - id: techcrunch_ai_category
    type: rss
    url: https://techcrunch.com/category/artificial-intelligence/feed/
    category: news
    authority: 0.80
    refresh_hours: 6
    lang: en
    notes: "AI vertical feed; still noisy."

  - id: venturebeat_rss
    type: rss_or_scrape
    url: https://venturebeat.com/category/ai/feed
    category: news
    authority: 0.76
    refresh_hours: 6
    lang: en
    notes: "RSS first; scrape fallback if feed unavailable."

  - id: a16z_future_feed
    type: rss
    url: https://future.com/feed
    category: tips
    authority: 0.82
    refresh_hours: 24
    lang: en
    notes: "Investor/operator essays; treat as tips/perspective."

  - id: theregister_ai_ml
    type: rss
    url: https://www.theregister.com/software/ai_ml/headlines.atom
    category: news
    authority: 0.70
    refresh_hours: 12
    lang: en
    notes: "Good for tooling + enterprise AI; filter hard."

  - id: strictlyvc_podcast
    type: rss
    url: https://feeds.megaphone.fm/YFL5140015188
    category: tips
    authority: 0.60
    refresh_hours: 24
    lang: en
    notes: "VC context; only keep AI-tagged episodes."

  - id: sequoia_training_data
    type: rss
    url: https://feeds.megaphone.fm/trainingdata
    category: tips
    authority: 0.75
    refresh_hours: 24
    lang: en
    notes: "High-signal interviews with AI builders."

# Scoring configuration
scoring:
  weights:
    authority: 0.30
    recency: 0.25
    popularity: 0.20
    relevance: 0.20
    dup_penalty: 0.05

  keywords_exclude:
    - "求人"
    - "採用"
    - "広告"
    - "affiliate"
    - "crypto"
    - "NFT"
    - "sponsored"
    - "advertisement"

  # Per-source quotas for digest
  quotas:
    arxiv_api_llm: 10
    zenn_llm: 15
    zenn_ai: 15
    qiita_llm: 15
    hn_ai: 15
    github_ai_repos: 10
    techcrunch_main: 6
    techcrunch_ai_category: 10
    venturebeat_rss: 10
    a16z_future_feed: 3
    theregister_ai_ml: 8
    strictlyvc_podcast: 4
    sequoia_training_data: 5
    default: 20

  # Minimum popularity thresholds
  min_popularity:
    hn_ai:
      points: 50
    reddit_localllama:
      score: 30
    github_ai_repos:
      stars: 50

# Category limits for daily digest
digest:
  limits:
    news: 20
    tips: 20
    paper: 10

# Schedule configuration (for launchd)
schedule:
  ingest_every_hours: 6
  digest_daily_hour_local: 8

# Performance tuning
performance:
  # Connector settings
  max_concurrent_sources: 10
  request_timeout_seconds: 30
  max_retries: 3
  retry_backoff_base: 2

  # Storage settings
  batch_size: 1000
  enable_wal: true
  cache_size_mb: 64

  # Deduplication settings
  similarity_threshold: 0.85
  use_embeddings: false  # Set to true for better dedup (requires embedding model)

  # Search settings
  search_results_per_page: 50
  fts_rank_weights: "1.0 0.5 0.3"  # title, content, metadata

# LLM configuration for summarization
llm:
  provider: local  # or: openai, anthropic, mock
  model: gpt-4o-mini
  max_tokens: 150
  temperature: 0.7
  concurrent_requests: 10
  cache_summaries: true
  # Local Ollama: model files go under project models/ when started with OLLAMA_MODELS=./models
  local_url: http://localhost:11434/v1
  local_model: smollm:1.7b
